<table class="images-list">
  <thead>
    <tr>
      <th>Preview</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    $each{ file in files }
    <tr class="_row $if{ /white|light/.test(file.path) }_bg-dark{/}">
        <td class="_img">
          <a href="${ cwd + '/' + file.path }" target="_blank">
            <img src="${ cwd + '/' + file.path }"/>
          </a>
        </td>
        <td class="_dimensions">
          <pre><code>width: ${ file.dimensions.width }px
height: ${ file.dimensions.height }px</code></pre>
        </td>
    </tr>
    <tr>
      <td class="_link" colspan="2">
        <input type="text" value="${ file.fullpath }"></input>
        <div class="-copied-text"></div>
        <button>‚éò</button>
      </td>
    </tr>
    {/}
  </tbody>
  </table>

  <script>
  (function (lang, texts) {

    texts = texts[lang]

    function _setText(el, text) {
      el.textContent = text
    }

    _setText( document.querySelector('table > thead > tr > th:nth-child(1)'), texts.tab_image )
    _setText( document.querySelector('table > thead > tr > th:nth-child(2)'), texts.tab_size )

    ;[].forEach.call(document.querySelectorAll('td._link'), function (td_el) {
      var input_el = td_el.querySelector('input')
      var button_el = td_el.querySelector('button')

      _setText( td_el.querySelector('.-copied-text'), texts.copied )

      function _onSuccess () {
        td_el.className = '_link _copied-ok'
        button_el.textContent = 'üëç'
        setTimeout(function () {
          td_el.className = '_link'
          button_el.textContent = '‚éò'
        }, 1600)
      }

      function _initClipboard () {
        button_el.addEventListener('click', function () {
          input_el.select()
          var success = document.execCommand("copy")
          if( success ) _onSuccess()
        })
      }

      // if( window.Clipboard ) {
      //   navigator.permissions.query({name: "clipboard-write"}).then(function() {
      //     new Clipboard(button_el, {
      //       target: function() {
      //         console.log('Clipboard target', input_el)
      //         return input_el
      //       }
      //     }).on('success', _onSuccess)
      //   }, _initClipboard)
      // } else {
      //   _initClipboard()
      // }
      _initClipboard()

      
    })
  })(navigator.language || navigator.userLanguage || 'en', {
    en: { copied: 'copied!', tab_image: 'Image', tab_size: 'Size' },
    es: { copied: 'copiado!', tab_image: 'Imagen', tab_size: 'Tama√±o' },
  })

  </script>
